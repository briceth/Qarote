---
alwaysApply: true
---

# Database Table Naming Standard

All database tables must use **PascalCase** naming convention consistently.

## Core Principle

- **Table names**: PascalCase (e.g., `User`, `Workspace`, `AlertRule`, `SeenAlert`)
- **Model names**: PascalCase (matches table names)
- **Relation field names**: camelCase (e.g., `user`, `workspace`, `alertRule`)

## Prisma Schema Rules

### ✅ Correct - PascalCase Table Names

```prisma
model User {
  id        String   @id @default(uuid())
  email     String   @unique
  workspace Workspace? @relation(fields: [workspaceId], references: [id])
}

model Workspace {
  id    String @id @default(uuid())
  name  String
  users User[]
}

model SeenAlert {
  id        String @id @default(uuid())
  fingerprint String @unique
  workspace Workspace @relation(fields: [workspaceId], references: [id])
}
```

### ❌ Incorrect - Using @@map for snake_case

```prisma
// ❌ Incorrect - Don't use @@map to override table names
model SeenAlert {
  id String @id @default(uuid())
  @@map("seen_alerts")  // ❌ Don't do this
}

// ✅ Correct - Let Prisma use PascalCase model name as table name
model SeenAlert {
  id String @id @default(uuid())
  // No @@map needed - table will be "SeenAlert"
}
```

## Relation Field Naming

### ✅ Correct - camelCase Relation Fields

```prisma
model Alert {
  id        String   @id @default(uuid())
  alertRule AlertRule? @relation(fields: [alertRuleId], references: [id])
  user      User?    @relation(fields: [createdById], references: [id])
  workspace Workspace @relation(fields: [workspaceId], references: [id])
}

model AlertRule {
  id        String   @id @default(cuid())
  alerts    Alert[]
  user      User     @relation(fields: [createdById], references: [id])
  workspace Workspace @relation(fields: [workspaceId], references: [id])
}
```

### ❌ Incorrect - PascalCase Relation Fields

```prisma
// ❌ Incorrect - Don't use PascalCase for relation field names
model Alert {
  id        String   @id @default(uuid())
  AlertRule AlertRule? @relation(...)  // ❌ Should be 'alertRule'
  User      User?    @relation(...)   // ❌ Should be 'user'
  Workspace Workspace @relation(...)  // ❌ Should be 'workspace'
}
```

## Code Usage

### ✅ Correct - Using camelCase in Code

```typescript
// Accessing models (Prisma client uses camelCase)
const user = await prisma.user.findUnique({ where: { id } });
const alert = await prisma.alert.findMany({ include: { alertRule: true } });
const workspace = await prisma.workspace.findUnique({
  include: { users: true, alerts: true },
});

// Accessing relations
const alertWithRule = await prisma.alert.findUnique({
  where: { id },
  include: {
    alertRule: true, // ✅ camelCase
    user: true, // ✅ camelCase
    workspace: true, // ✅ camelCase
  },
});
```

### ❌ Incorrect - Using PascalCase in Code

```typescript
// ❌ Incorrect - Don't use PascalCase for Prisma client access
const user = await prisma.User.findUnique(...);  // ❌ Should be 'user'
const alert = await prisma.Alert.findMany({
  include: { AlertRule: true }  // ❌ Should be 'alertRule'
});
```

## Migration Guidelines

When creating new tables:

1. **Use PascalCase for model names** - This becomes the table name
2. **Never use `@@map`** - Let Prisma use the model name directly
3. **Use camelCase for relation fields** - Follow Prisma conventions
4. **Add `@default(uuid())` to id fields** - For proper type safety
5. **Add `@updatedAt` to updatedAt fields** - For automatic timestamp updates

## Examples

### Creating a New Table

```prisma
// ✅ Correct
model NotificationSettings {
  id          String    @id @default(uuid())
  userId      String
  enabled     Boolean   @default(true)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  user        User      @relation(fields: [userId], references: [id])

  @@index([userId])
}
```

### Existing Tables

All existing tables follow this standard:

- `User`, `Workspace`, `Alert`, `AlertRule`
- `SeenAlert`, `ResolvedAlert`, `Webhook`, `SlackConfig`
- `Subscription`, `License`, `Payment`, `StripeWebhookEvent`
- `Queue`, `QueueMetric`, `RabbitMQServer`
- `EmailVerificationToken`, `PasswordReset`, `Invitation`, `Feedback`
- `WorkspaceAlertThresholds`

## Benefits

- **Consistency**: All tables follow the same naming pattern
- **Type Safety**: Prisma client types match the schema exactly
- **Maintainability**: Easy to understand and navigate
- **No Mapping Overhead**: Direct mapping between model names and table names
- **Standard Convention**: Follows Prisma best practices

## Migration from snake_case

If you encounter old code or migrations with snake_case table names:

1. **Update the Prisma schema** - Remove `@@map` directives
2. **Create a migration** - Use `ALTER TABLE` to rename tables
3. **Update code** - Ensure relation field names are camelCase
4. **Regenerate Prisma client** - Run `npx prisma generate`
