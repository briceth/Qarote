echo "ğŸ” Running type checks before push..."

# Get the remote branch name (default to main)
remote_branch=${1:-main}

# Run type-check for backend if any backend files changed
if git diff --name-only $remote_branch...HEAD | grep -q "^apps/back-end/"; then
  echo "ğŸ“¦ Checking backend types..."
  npm run type-check --workspace=apps/back-end || exit 1
fi

# Run type-check for frontend if any frontend files changed
if git diff --name-only $remote_branch...HEAD | grep -q "^apps/front-end/"; then
  echo "ğŸ“¦ Checking frontend types..."
  npm run type-check --workspace=apps/front-end || exit 1
fi

# Run type-check for landing if any landing files changed
if git diff --name-only $remote_branch...HEAD | grep -q "^apps/landing/"; then
  echo "ğŸ“¦ Checking landing types..."
  npm run type-check --workspace=apps/landing || exit 1
fi

# Run type-check for customer-portal if any customer-portal files changed
if git diff --name-only $remote_branch...HEAD | grep -q "^apps/customer-portal/"; then
  echo "ğŸ“¦ Checking customer-portal types..."
  npm run type-check --workspace=apps/customer-portal || exit 1
fi

# Run type-check for landing if any landing files changed
if git diff --name-only $remote_branch...HEAD | grep -q "^apps/landing/"; then
  echo "ğŸ“¦ Checking landing types..."
  npm run type-check --workspace=apps/landing || exit 1
fi

# Run type-check for customer-portal if any customer-portal files changed
if git diff --name-only $remote_branch...HEAD | grep -q "^apps/customer-portal/"; then
  echo "ğŸ“¦ Checking customer-portal types..."
  npm run type-check --workspace=apps/customer-portal || exit 1
fi

echo "âœ… All type checks passed!"
